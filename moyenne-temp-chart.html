<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Temperature Data</title>
  <script src="https://cdn.jsdelivr.net/npm/apexcharts"></script>
</head>
<body>

<div id="chart"></div>


<script>
  document.addEventListener("DOMContentLoaded", function(event) {
    // Data
    const years = [
      1901, 1902, 1903, 1904, 1905, 1906, 1907, 1908, 1909, 1910,
      1911, 1912, 1913, 1914, 1915, 1916, 1917, 1918, 1919, 1920,
      1921, 1922, 1923, 1924, 1925, 1926, 1927, 1928, 1929, 1930,
      1931, 1932, 1933, 1934, 1935, 1936, 1937, 1938, 1939, 1940,
      1941, 1942, 1943, 1944, 1945, 1946, 1947, 1948, 1949, 1950,
      1951, 1952, 1953, 1954, 1955, 1956, 1957, 1958, 1959, 1960,
      1961, 1962, 1963, 1964, 1965, 1966, 1967, 1968, 1969, 1970,
      1971, 1972, 1973, 1974, 1975, 1976, 1977, 1978, 1979, 1980,
      1981, 1982, 1983, 1984, 1985, 1986, 1987, 1988, 1989, 1990,
      1991, 1992, 1993, 1994, 1995, 1996, 1997, 1998, 1999, 2000,
      2001, 2002, 2003, 2004, 2005, 2006, 2007, 2008, 2009, 2010, 2011
    ];

    const temperatures = [
      10.8, 11, 11.2, 11.7, 11, 11.5, 11.2, 11.2, 10.6, 11.1,
      12, 11.1, 11.7, 11.2, 11.1, 11.3, 10.3, 11.4, 10.8, 11.6,
      12.2, 10.9, 11.4, 11.2, 10.9, 11.9, 11.4, 12, 11.4, 11.9,
      11, 11.3, 11.4, 11.9, 11.5, 11.6, 12, 11.5, 11.3, 10.7,
      10.6, 11.2, 12.3, 11.2, 12.2, 11.3, 12.4, 12, 12.4, 11.9,
      11.5, 11.6, 11.6, 11, 11.6, 10.2, 11.6, 11.5, 12.3, 11.5,
      12.3, 10.8, 10.4, 11.5, 11, 11.8, 11.7, 11.3, 11.3, 11.4,
      11.4, 11, 11.3, 11.6, 11.5, 11.8, 11.6, 11.1, 11.3, 11,
      11.6, 12.4, 12.1, 11.4, 11.1, 11.4, 11.4, 12.2, 12.8, 12.8,
      11.8, 12.1, 11.8, 13.1, 12.7, 11.7, 12.9, 12.3, 12.7, 12.9,
      12.5, 12.9, 13.1, 12.3, 12.3, 12.9, 12.6, 12.3, 11.1, 11.6,
      13.4
    ];

    // Calculate average temperature
    const averageTemperature = temperatures.reduce((acc, val) => acc + val, 0) / temperatures.length;


    const shiftedTemperatures = temperatures.map(temp => temp - averageTemperature);

    // Create chart
    var options = {
      chart: {
        type: 'bar',
        height: 450,
        toolbar: {
          show: false
        }
      },
      plotOptions: {
        bar: {
          horizontal: false,
          colors: {
            ranges: [
              {
                from: -Infinity,
                to: 0,
                color: '#3e9efa'
              },
              {
                from: 0,
                to: Infinity,
                color: '#fe6276'
              }
            ]
          }
        }
      },
      dataLabels: {
        enabled: false
      },
      series: [{
        name: 'Temperature (°C)',
        data: shiftedTemperatures
      }],
      xaxis: {
        categories: years,
        title: {
          text: 'Année'
        },
        tickAmount: 20
      },
      yaxis: {
        max: 2,
        title: {
          text: 'Écart à la moyenne (°C)'
        },
        labels: {
          formatter: function (value) {
            return value.toFixed(1);
          }
        }
      },
      tooltip: {
        y: {
          formatter: function (val) {
            if (val < 0) {
              return (val * -1).toFixed(1) + '°C en dessous de la moyenne';
            } else {
              return val.toFixed(1) + '°C au-dessus de la moyenne';
            }
          },
          title: {
            formatter: function (val) {
              return "";
            }
          }
        },
        x: {
          formatter: function (val) {
            return "Année " + val;
          }
        }
      }
    }

    var chart = new ApexCharts(document.querySelector("#chart"), options);

    chart.render();
  });
</script>

</body>
</html>